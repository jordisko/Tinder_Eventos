
DROP DATABASE IF EXISTS `baseDatosMeetOut` ;

CREATE DATABASE IF NOT EXISTS `baseDatosMeetOut`  ;
USE `baseDatosMeetOut` ;

DROP TABLE IF EXISTS `baseDatosMeetOut`.`Usuarios` ;

CREATE TABLE IF NOT EXISTS `baseDatosMeetOut`.`Usuarios` (
  `idUsuario` INT NOT NULL AUTO_INCREMENT,
  `nombreUsuario` VARCHAR(12) NOT NULL,
  `correoElectronico` VARCHAR(45) NOT NULL,
  `contraseniaUsuario` VARCHAR(45) NOT NULL,
  `fotoUsuario` VARCHAR(155) NULL,
  `descripcionUsuario` VARCHAR(155) NULL DEFAULT '\"Aún no he puesto mi descripción\'',
  `nombrePersona` VARCHAR(45) NULL,
  `apellidoPersona` VARCHAR(45) NULL,
  `codigoPostal` VARCHAR(45) NULL,
  PRIMARY KEY (`idUsuario`));

DROP TABLE IF EXISTS `baseDatosMeetOut`.`Eventos` ;

CREATE TABLE IF NOT EXISTS `baseDatosMeetOut`.`Eventos` (
  `idEvento` INT NOT NULL AUTO_INCREMENT,
  `nombreEvento` VARCHAR(30) NOT NULL,
  `descripcionEvento` VARCHAR(155) NOT NULL,
  `codigoPostalLocalizacionEvento` INT(5) NOT NULL,
  `personasMaxEvento` INT(5) NOT NULL,
  `fechaEvento` DATE NULL,
  `horaEvento` TIME NULL,
  `direccionLocalizacionEvento` VARCHAR(45) NULL,
  `tipoDeEvento` VARCHAR(55) NULL,
  `fotoEvento` longtext NULL,
  `estadoEvento` VARCHAR(12) NULL,
  PRIMARY KEY (`idEvento`));
  


DROP TABLE IF EXISTS `baseDatosMeetOut`.`Matches` ;

CREATE TABLE IF NOT EXISTS `baseDatosMeetOut`.`Matches` (
  `idMatch` INT NOT NULL AUTO_INCREMENT,
  `Usuarios_idUsuario` INT NOT NULL,
  `Eventos_idEvento` INT NOT NULL,
  `estadoMatch` tinyint NOT NULL DEFAULT 0,
  PRIMARY KEY (`idMatch`),
  CONSTRAINT `fk_Match_Usuarios`
    FOREIGN KEY (`Usuarios_idUsuario`)
    REFERENCES `baseDatosMeetOut`.`Usuarios` (`idUsuario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Match_Eventos1`
    FOREIGN KEY (`Eventos_idEvento`)
    REFERENCES `baseDatosMeetOut`.`Eventos` (`idEvento`)
    ON DELETE NO ACTION
    ON UPDATE cascade);

#INSERT iNTO basedatosmeetout.usuarios(nombreUsuario, correoElectronico, contraseniaUsuario, fotoUsuario, descripcionUsuario, nombrePersona, apellidoPersona, codigoPostal)
#VALUES
INSERT INTO `basedatosmeetout`.`eventos` (`nombreEvento`, `descripcionEvento`, `codigoPostalLocalizacionEvento`, `personasMaxEvento`, `fechaEvento`,`horaEvento`, `direccionLocalizacionEvento`, `tipoDeEvento`, `fotoEvento`,`estadoEvento`) VALUES ('Cine', 'Vamos a ver tarzan', '08031', '10', '2022-09-29','20:30:00','arco de triunfo 208', 'cultural', 'data:image/jpeg;base64,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',"activo");


SELECT * from basedatosmeetout.eventos;
    
INSERT INTO `basedatosmeetout`.`usuarios` ( `nombreUsuario`, `correoElectronico`, `contraseniaUsuario`, `fotoUsuario`, `descripcionUsuario`, `nombrePersona`, `apellidoPersona`, `codigoPostal`) VALUES ('jordisko', 'jordicampos.97@gmail.com', '1234', 'https://i.imgur.com/58xTTQM.png', 'No se que poner', 'Jordi', 'Campos', '08031');
SELECT * from basedatosmeetout.usuarios;

select Usuarios_idUsuario from matches WHERE Eventos_idEvento = 1;
SELECT IdEvento  from eventos where IdEvento not in (select Eventos_idEvento from Matches where usuarios_idUsuario = 1) AND codigoPostalLocalizacionEvento =ANY(SELECT codigoPostal from usuarios where idUsuario =1);
INSERT INTO `basedatosmeetout`.`matches` (`idMatch`, `Usuarios_idUsuario`, `Eventos_idEvento`, `estadoMatch`) VALUES ('1', '1', '1', '1');





